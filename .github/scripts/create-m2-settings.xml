#!/bin/bash

if [ -z "${SONATYPE_USERNAME}" ]; then
    echo "Set SONATYPE_USERNAME to continue";
    exit 1
fi

if [ -z "${SONATYPE_PASSWORD}" ]; then
    echo "Set SONATYPE_PASSWORD to continue";
    exit 1
fi

root=$(cd "$(dirname "$0")/../.." && pwd)

mkdir -p "${root}/.m2"
cat <<EOF > "${root}/.m2/settings.xml"
<settings>
    <servers>
        <server>
        <id>ossrh</id>
        <username>${SONATYPE_USERNAME}</username>
        <password>${SONATYPE_PASSWORD}</password>
        </server>
    </servers>
</settings>
EOF

exit 0
